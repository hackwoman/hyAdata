# 行业研报数据爬虫系统

一个专业的行业研报数据收集和分析系统，通过爬虫程序从各券商和专业网站收集行业研报数据，提取关键指标，并以Excel表格形式呈现和保存。

## 功能特点

- 🕷️ **多源数据收集**: 支持从东方财富网、新浪财经、和讯网等多个数据源收集数据
- 📊 **关键指标提取**: 自动提取行业渗透率、产能利用率、平均毛利率等关键指标
- 🏢 **龙头企业分析**: 每个细分行业包含3家龙头企业实例
- 📈 **数据可视化**: 生成多种图表和报告，直观展示行业趋势
- 📋 **多格式输出**: 支持Excel、CSV、JSON等多种数据格式
- 🔧 **灵活配置**: 支持自定义行业列表、数据源配置等
- 📝 **详细日志**: 完整的操作日志记录

## 支持的新兴细分行业

系统支持以下20个新兴细分行业的数据收集：

1. 人工智能
2. 新能源汽车
3. 半导体
4. 生物医药
5. 5G通信
6. 云计算
7. 物联网
8. 区块链
9. 氢能源
10. 储能技术
11. 机器人
12. AR/VR
13. 量子计算
14. 基因治疗
15. 碳中和技术
16. 芯片设计
17. 自动驾驶
18. 智能制造
19. 数字孪生
20. 边缘计算

## 关键指标说明

- **行业渗透率(%)**: 行业产品在目标市场中的普及程度
- **产能利用率(%)**: 企业实际产能与设计产能的比率
- **平均毛利率(%)**: 企业毛利润与营业收入的比率
- **市场规模(亿元)**: 行业总体市场规模
- **年增长率(%)**: 行业年度增长率

## 安装要求

### 系统要求
- Python 3.7+
- Windows/Linux/macOS

### 依赖安装

```bash
# 安装项目依赖
pip install -r requirements.txt
```

### 主要依赖包
- `requests`: HTTP请求库
- `beautifulsoup4`: HTML解析库
- `pandas`: 数据处理库
- `openpyxl`: Excel文件操作
- `selenium`: 浏览器自动化
- `matplotlib`: 数据可视化
- `seaborn`: 统计图表库

## 使用方法

### 基本使用

```bash
# 爬取所有行业数据
python main.py

# 爬取指定行业数据
python main.py -i 人工智能 新能源汽车 半导体

# 输出CSV格式
python main.py -f csv

# 输出所有格式
python main.py -f all

# 不生成图表
python main.py --no-charts
```

### 高级功能

```bash
# 列出所有支持的行业
python main.py --list

# 显示配置的数据源
python main.py --sources

# 显示当前配置信息
python main.py --config
```

### 命令行参数说明

| 参数 | 说明 | 示例 |
|------|------|------|
| `-i, --industries` | 指定要爬取的行业 | `-i 人工智能 新能源汽车` |
| `-f, --format` | 输出格式 | `-f excel` (excel/csv/json/all) |
| `--no-charts` | 不生成图表 | `--no-charts` |
| `--list` | 列出所有行业 | `--list` |
| `--sources` | 显示数据源 | `--sources` |
| `--config` | 显示配置信息 | `--config` |

## 输出文件说明

### Excel文件结构
生成的Excel文件包含以下工作表：

1. **行业数据**: 详细的行业和企业数据
   - 行业名称
   - 企业名称
   - 行业渗透率(%)
   - 产能利用率(%)
   - 平均毛利率(%)
   - 市场规模(亿元)
   - 年增长率(%)
   - 数据来源
   - 更新时间

2. **行业汇总**: 各行业关键指标汇总
   - 按行业分组的平均值和总和

3. **龙头企业排名**: 按毛利率排名的前20家企业

### 可视化图表
系统会生成以下图表：

- **行业概览图**: 各行业关键指标对比
- **指标相关性热力图**: 关键指标间的相关性分析
- **龙头企业分析**: 龙头企业排名和分布
- **行业雷达图**: 行业综合实力对比
- **增长趋势分析**: 行业发展趋势分析

## 项目结构

```
industry-report-crawler/
├── main.py                    # 主程序入口
├── config.py                  # 配置文件
├── industry_report_crawler.py # 爬虫核心模块
├── data_visualization.py      # 数据可视化模块
├── requirements.txt           # 依赖包列表
├── README.md                  # 项目说明文档
├── output/                    # 数据输出目录
├── reports/                   # 图表输出目录
├── logs/                      # 日志文件目录
└── backup/                    # 备份文件目录
```

## 配置说明

### 环境配置
通过环境变量 `ENVIRONMENT` 选择配置：
- `development`: 开发环境配置
- `production`: 生产环境配置

```bash
# 设置环境
export ENVIRONMENT=production
```

### 数据源配置
在 `config.py` 中可以配置数据源：

```python
DATA_SOURCES = {
    "东方财富网": {
        "base_url": "http://data.eastmoney.com",
        "enabled": True,
        "delay_range": (1, 3),
        "timeout": 30
    },
    # ... 其他数据源
}
```

### 行业列表配置
可以自定义要爬取的行业列表：

```python
EMERGING_INDUSTRIES = [
    "人工智能",
    "新能源汽车",
    # ... 添加更多行业
]
```

## 注意事项

1. **反爬虫机制**: 系统已内置反爬虫措施，包括随机延迟、User-Agent轮换等
2. **数据准确性**: 当前版本使用模拟数据，实际使用时需要实现真实的数据爬取逻辑
3. **网络连接**: 确保网络连接稳定，某些数据源可能需要VPN访问
4. **存储空间**: 确保有足够的磁盘空间存储数据和图表文件

## 扩展开发

### 添加新的数据源
1. 在 `config.py` 中添加数据源配置
2. 在 `industry_report_crawler.py` 中实现爬取方法
3. 在 `process_industry_data` 方法中调用新的爬取方法

### 添加新的行业
1. 在 `config.py` 的 `EMERGING_INDUSTRIES` 列表中添加行业名称
2. 确保数据生成逻辑支持新行业

### 自定义可视化图表
1. 在 `data_visualization.py` 中添加新的图表方法
2. 在 `generate_comprehensive_report` 方法中调用新方法

## 许可证

本项目采用 MIT 许可证，详见 LICENSE 文件。

## 贡献

欢迎提交 Issue 和 Pull Request 来改进项目。

## 联系方式

如有问题或建议，请通过以下方式联系：
- 提交 GitHub Issue
- 发送邮件至项目维护者

---

**免责声明**: 本工具仅用于学习和研究目的，请遵守相关网站的使用条款和robots.txt文件。使用者应自行承担使用风险。 